---
title: "函式程式設計 Part 2 - 分辨動作，計算和資料"
description: 本篇記錄如何分辨函式程式設計內的動作，計算和資料
date: 2025-09-07
tags: ["javascript", "fp", "functional programming", "reading note"]
published: false
language: "zh_tw"
---

簡單回顧上一篇[函式程式設計 part 1 - 概念](/zh_tw/blog/functional-programming-part-1-concept-zh_tw)，函式程式設計會將程式區分三大類別：

**動作 (Action)**

- 會產生副作用(Side effect)，最受時間因素影響，最不易控制
- 也稱「額外作用函式」，非純函式(Impure functions)
- 例如：傳送電子郵件，從資料庫讀取資料

**計算 (Calculations)**

- 與時間無關，較好控制
- 透過運算將輸入轉為輸出
- 又稱「純函式」或「數學函式」(Pure functions)
- 例如：找出最大值，確認電子信箱地址格式是否正確

**資料 (Data)**

- 被動且需要被解讀的元素，關於各種事件的事實紀錄
- 例如：使用者輸入的地址或從 API 讀取到的金額

## 生活中的 ACD

以買菜來說，可以大致區分這幾個動作：

- 檢查冰箱
- 開車到賣場
- 購買需要的菜
- 開車回家

乍看之下好像什麼都是動作，但其實每個動作都有部分需要考慮的計算與資料，如果把上述的動作仔細拆分的話，都可以找到對應的計算跟資料。

### 拆分動作找出其中的計算與資料

#### 檢查冰箱

我們會需要做的就是查看目前冰箱內有什麼物品，因此我們需要知道菜啊，肉啊還有多少 (Calculations) 並列出目前存貨 (Data)。

#### 開車到賣場

這個動作基本上會需要的資料很多，但是與採購這件事情較無關係，除非我們今天要設計的是針對駕駛或者路徑最佳化等，那麼我們就會需要例如：
賣場的位置、路線或所耗費的汽油等。

#### 購買需要的菜

我們在檢查冰箱時，透過計算得出的目前存貨，在進行採購時要決定的當然就是買多少，而買多少可以透過「目前存量」來進行計算來生成一個購物清單，
所以我們會有三個資料，一個計算以及一個動作

- 動作
  - 按照購物清單採買
- 計算
  - 需要的食材 - 目前存量
- 資料
  - 目前存貨
  - 需要的食材
  - 購物清單

```markdown
購物清單(Data) = 需要的食材(Data) - 目前存量(Data)
```

#### 開車回家

開車回家和驅車前往賣場差不多，中間也是會有一些計算和資料，但是與此例子較無直接關係。

### 資料

資料是關於事件的事實紀錄，以 JS 來說，就是透過例如數字、字串、陣列等資料結構來建立資料。當我們選擇一個資料結構時，這個結構需要反映
Domain 中的資訊，這裡的 Domain 指得是和目標/問題有關的訊息或知識，以購買清單來說，它的順序不是很重要，那麼選擇的資料結構針對順序就
不需要太在意，換言之，如果是說明書，可能在組裝的時候順序是很重要的，那麼這個資料結構就必須要能保有其順序。

函式程式設計，會盡可能地透過以下方式來達到資料的不變性：

1. 寫入時複製(Copy-on-write)：更動資料前先複製。
2. 防禦性複製(Defensive copying): 複製需要保留的資料。

### 結論

以上只是舉生活的例子來熟悉如何分辨動作、計算和資料，上述的採買一定還有許多細節可以進一步區分

- 動作可能藏有計算和資料，盡可能地我們撰寫的程式碼若能清楚地劃分，會更能夠方便我們管理。
- 計算也可能由其他計算跟資料組成，函式程式設計是希望保持純函式，因此每一個計算最好都能夠做好自己的本職，以一個輸入一個輸出為目標。
  - 計算也可能比較容易被忽略，若能養成問自己「哪些需要做決策」，或者哪些是需要透過資料才能得到的。
- 資料僅僅是資料，若可以在一個大型的動作跟計算中，先找出這個固定的因子，會更好處理。
